#!/usr/bin/env python
# -*- coding: utf-8 -*- 

import sys
import os
import math
import time
import threading
import multiprocessing

import json
import re
import collections
# import enchant

from struct import pack, unpack
from pprint import pprint
from os import listdir
from os.path import isfile, join

# !\"#$%&'()*+,-./0123456789:;<=>?@ \n \ " " [] formula_
# :+| removed for Category

WIKI_DELIMITERS = '>+|<+|!+|\$+|\#+|\%+|–+|\&+|]+|\[+|,+| +|;+|=+|\|+|-+|\++|\(+|\)+|\?+|\'+|\"+|\`+|\n+|\.+|\/+|\*+|\‘+|“+|—+|_+|~+'
# WIKI_DELIMITERS = '>+|<+|!+|#+|$+|\%+|\&+|\@+|]+|\[+|,+| +|;+|=+|\|+|-+|\++|\(+|\)+|\?+|\'+|\"+|\`+|\n+|:+|\.+|\/+|\*+|\‘+|“+'

DUMP_PATH = 'text/'
# DUMP_PATH = '../128mb_json/'
#DUMP_PATH = '../40gb_json/'

SECTIONS = 10

class InvertedIndex:
    def __init__(self):
        self.no_words = []
        self.stop_words = {'a':1,'about':1,'above':1,'across':1,'after':1,'afterwards':1,'again':1,'against':1,'all':1,'almost':1,'alone':1,'along':1,'already':1,'also':1,'although':1,'always':1,'am':1,'among':1,'amongst':1,'amoungst':1,'amount':1,'an':1,'and':1,'another':1,'any':1,'anyhow':1,'anyone':1,'anything':1,'anyway':1,'anywhere':1,'are':1,'around':1,'as':1,'at':1,'back':1,'be':1,'became':1,'because':1,'become':1,'becomes':1,'becoming':1,'been':1,'before':1,'beforehand':1,'behind':1,'being':1,'below':1,'beside':1,'besides':1,'between':1,'beyond':1,'bill':1,'both':1,'bottom':1,'but':1,'by':1,'call':1,'can':1,'cannot':1,'cant':1,'co':1,'con':1,'could':1,'couldnt':1,'cry':1,'de':1,'describe':1,'detail':1,'do':1,'done':1,'down':1,'due':1,'during':1,'each':1,'eg':1,'eight':1,'either':1,'eleven':1,'else':1,'elsewhere':1,'empty':1,'enough':1,'etc':1,'even':1,'ever':1,'every':1,'everyone':1,'everything':1,'everywhere':1,'except':1,'few':1,'fifteen':1,'fify':1,'fill':1,'find':1,'fire':1,'first':1,'five':1,'for':1,'former':1,'formerly':1,'forty':1,'found':1,'four':1,'from':1,'front':1,'full':1,'further':1,'get':1,'give':1,'go':1,'had':1,'has':1,'hasnt':1,'have':1,'he':1,'hence':1,'her':1,'here':1,'hereafter':1,'hereby':1,'herein':1,'hereupon':1,'hers':1,'herself':1,'him':1,'himself':1,'his':1,'how':1,'however':1,'hundred':1,'ie':1,'if':1,'in':1,'inc':1,'indeed':1,'interest':1,'into':1,'is':1,'it':1,'its':1,'itself':1,'keep':1,'last':1,'latter':1,'latterly':1,'least':1,'less':1,'ltd':1,'made':1,'many':1,'may':1,'me':1,'meanwhile':1,'might':1,'mill':1,'mine':1,'more':1,'moreover':1,'most':1,'mostly':1,'move':1,'much':1,'must':1,'my':1,'myself':1,'name':1,'namely':1,'neither':1,'never':1,'nevertheless':1,'next':1,'nine':1,'no':1,'nobody':1,'none':1,'noone':1,'nor':1,'not':1,'nothing':1,'now':1,'nowhere':1,'of':1,'off':1,'often':1,'on':1,'once':1,'one':1,'only':1,'onto':1,'or':1,'other':1,'others':1,'otherwise':1,'our':1,'ours':1,'ourselves':1,'out':1,'over':1,'own':1,'part':1,'per':1,'perhaps':1,'please':1,'put':1,'rather':1,'re':1,'same':1,'see':1,'seem':1,'seemed':1,'seeming':1,'seems':1,'serious':1,'several':1,'she':1,'should':1,'show':1,'side':1,'since':1,'sincere':1,'six':1,'sixty':1,'so':1,'some':1,'somehow':1,'someone':1,'something':1,'sometime':1,'sometimes':1,'somewhere':1,'still':1,'such':1,'system':1,'take':1,'ten':1,'than':1,'that':1,'the':1,'their':1,'them':1,'themselves':1,'then':1,'thence':1,'there':1,'thereafter':1,'thereby':1,'therefore':1,'therein':1,'thereupon':1,'these':1,'they':1,'thickv':1,'thin':1,'third':1,'this':1,'those':1,'though':1,'three':1,'through':1,'throughout':1,'thru':1,'thus':1,'to':1,'together':1,'too':1,'top':1,'toward':1,'towards':1,'twelve':1,'twenty':1,'two':1,'un':1,'under':1,'until':1,'up':1,'upon':1,'us':1,'very':1,'via':1,'was':1,'we':1,'well':1,'were':1,'what':1,'whatever':1,'when':1,'whence':1,'whenever':1,'where':1,'whereafter':1,'whereas':1,'whereby':1,'wherein':1,'whereupon':1,'wherever':1,'whether':1,'which':1,'while':1,'whither':1,'who':1,'whoever':1,'whole':1,'whom':1,'whose':1,'why':1,'will':1,'with':1,'within':1,'without':1,'would':1,'yet':1,'you':1,'your':1,'yours':1,'yourself':1,'yourselves':1,'the':1,'mdy':1,'ebg':1,'eba':1,'ebc':1,'ebm':1,'ebn':1,'ebo':1,'ebi':1,'ebj':1,'ebt':1,'ebu':1,'ebv':1,'ebp':1,'ebr':1,'ebx':1}
        self.is_integer = lambda s: not s.isdigit()
        # self.eng_dict = enchant.Dict("en_US")
        # self.docIDmap = {6787:1,7023:2,5584:3,1950:4,8182:5,5224:6,2736:7,4563:8,3875:9,307:10,872:11,863:12,3856:13,4545:14,2085:15,6886:16,6576:17,1624:18,5959:19,5489:20,874:21,4335:22,1078:23,4973:24,1214:25,6654:26,8060:27,5254:28,2983:29,880:30,5142:31,737:32,5326:33,1973:34,4314:35,4339:36,3383:37,3338:38,1273:39,1921:40,5945:41,856:42,3986:43,7222:44,4173:45,6851:46,5405:47,771:48,2508:49,3463:50,5166:51,5314:52,1998:53,4477:54,5407:55,5882:56,6310:57,7701:58,8209:59,3392:60,5951:61,6859:62,5950:63,1845:64,4606:65,3985:66,7270:67,621:68,5766:69,5573:70,303:71,3850:72,624:73,6816:74,4721:75,627:76,5391:77,5211:78,4652:79,5416:80,7236:81,1715:82,5408:83,3012:84,5222:85,3356:86,6117:87,3382:88,7045:89,5247:90,8311:91,5046:92,8389:93,5942:94,4293:95,6062:96,2116:97,6355:98,6884:99,4284:100,12:101,7952:102,2140:103,3460:104,7185:105,3722:106,6827:107,4953:108,7426:109,1494:110,6671:111,844:112,4157:113,2154:114,6237:115,1859:116,2011:117,783:118,5399:119,808:120,8474:121,8063:122,666:123,5645:124,3458:125,852:126,7891:127,1806:128,8205:129,3354:130,1177:131,3410:132,6652:133,746:134,7463:135,4800:136,7732:137,4997:138,5902:139,1627:140,7502:141,717:142,1178:143,3462:144,1461:145,848:146,3454:147,7712:148,6466:149,5593:150,7819:151,5635:152,4356:153,7044:154,1148:155,308:156,4402:157,4667:158,3138:159,5592:160,5786:161,738:162,3717:163,3352:164,1640:165,4298:166,6678:167,3916:168,2547:169,4614:170,6883:171,7959:172,1930:173,4165:174,5760:175,2176:176,7966:177,4849:178,1132:179,8029:180,1938:181,6644:182,3793:183,4243:184,4340:185,4401:186,358:187,6675:188,1942:189,2386:190,5935:191,4874:192,7564:193,5374:194,4054:195,3921:196,5648:197,981:198,7566:199,2130:200,803:201,2006:202,8103:203,4294:204,7955:205,2594:206,2382:207,594:208,4246:209,4183:210,902:211,7738:212,7742:213,1023:214,4375:215,5321:216,4543:217,5199:218,5664:219,6546:220,5134:221,1017:222,8367:223,1216:224,4035:225,3746:226,7211:227,573:228,4010:229,2357:230,8504:231,8121:232,8082:233,7729:234,8418:235,3408:236,7053:237,3995:238,6690:239,5884:240,736:241,3671:242,2944:243,4675:244,25:245,4650:246,6611:247,5787:248,5490:249,3415:250,2377:251,2861:252,5981:253,5702:254,2864:255,5253:256,7475:257,954:258,1094:259,4057:260,6140:261,2321:262,1814:263,2257:264,6653:265,8494:266,8420:267,7382:268,1530:269,3343:270,5382:271,1365:272,1208:273,6614:274,5659:275,4443:276,4049:277,7316:278,2030:279,864:280,8253:281,3457:282,7390:283,4960:284,663:285,4531:286,1537:287,4792:288,6195:289,3833:290,4952:291,4572:292,1623:293,4770:294,8340:295,5218:296,4717:297,3390:298,4615:299,4116:300,7172:301,8520:302,1576:303,2067:304,2303:305,5655:306,6629:307,802:308,8408:309,5233:310,6452:311,4781:312,765:313,7925:314,5906:315,6760:316,2148:317,6966:318,1495:319,2778:320,1914:321,4620:322,2141:323,4660:324,2065:325,3466:326,1980:327,4482:328,6068:329,5943:330,1130:331,701:332,3117:333,3363:334,5751:335,5813:336,1206:337,2965:338,8377:339,4860:340,5551:341,6749:342,2787:343,6021:344,339:345,3083:346,5371:347,7930:348,1203:349,8083:350,1970:351,6999:352,5363:353,1395:354,3277:355,7587:356,2122:357,4410:358,4887:359,7056:360,752:361,6433:362,6822:363,3973:364,6446:365,4041:366,3376:367,6731:368,5735:369,7683:370,3956:371,4147:372,1164:373,2388:374,3416:375,7525:376,4986:377,3778:378,6824:379,3201:380,3226:381,5575:382,7697:383,6852:384,3742:385,2425:386,7783:387,6059:388,5658:389,7293:390,7200:391,700:392,5907:393,1022:394,6340:395,1347:396,2704:397,4318:398,775:399,4996:400,1812:401,569:402,6868:403,4695:404,6293:405,3708:406,3674:407,4050:408,2007:409,5478:410,8484:411,3355:412,4396:413,2403:414,8242:415,6728:416,4379:417,2460:418,2185:419,984:420,3736:421,4092:422,6187:423,1625:424,5962:425,4550:426,5299:427,2847:428,6613:429,1384:430,7104:431,1525:432,662:433,5468:434,2084:435,689:436,5180:437,4745:438,4348:439,6014:440,4149:441,7602:442,4329:443,2174:444,7089:445,5646:446,904:447,5826:448,3873:449,1451:450,3631:451,4566:452,3637:453,1965:454,791:455,5685:456,897:457,5980:458,2995:459,1000:460,2241:461,5447:462,6597:463,8498:464,5717:465,8485:466,8402:467,3052:468,1182:469,5488:470,4806:471,6704:472,5698:473,3451:474,6610:475,3755:476,3378:477,6984:478,5576:479,6558:480,7839:481,7345:482,7893:483,7473:484,2215:485,4726:486,2642:487,7299:488,4502:489,1791:490,7840:491,3947:492,8091:493,4473:494,6046:495,4251:496,3455:497,4146:498,5704:499,1784:500,8301:501,4207:502,3080:503,5689:504,4746:505,4077:506,6719:507,4312:508,7627:509,8122:510,5278:511,7442:512,6710:513,6910:514,7593:515,1338:516,691:517,8521:518,5574:519,3022:520,6235:521,674:522,7527:523,3470:524,2273:525,3772:526,595:527,1029:528,4342:529,2792:530,4868:531,2393:532,5360:533,8166:534,6591:535,3225:536,8300:537,1030:538,7940:539,639:540,1881:541,5905:542,4384:543,1902:544,4368:545,3464:546,6449:547,5654:548,4200:549,7810:550,5820:551,2834:552,8256:553,1770:554,2400:555,5667:556,3155:557,4037:558,2103:559,2362:560,4501:561,8254:562,5823:563,900:564,7591:565,5588:566,2219:567,7586:568,4463:569,5428:570,2493:571,5987:572,3335:573,1997:574,3969:575,8237:576,1979:577,4218:578,6024:579,5810:580,4360:581,6670:582,2963:583,5623:584,4031:585,4489:586,3970:587,6095:588,5931:589,1034:590,7601:591,5879:592,634:593,3735:594,5669:595,6429:596,4911:597,931:598,6260:599,1446:600,5992:601,3989:602,4163:603,8099:604,336:605,2411:606,7376:607,1315:608,5030:609,3997:610,2144:611,1701:612,2703:613,8468:614,6655:615,2115:616,4829:617,7397:618,6734:619,6865:620,5403:621,5666:622,1348:623,6066:624,2428:625,8303:626,1368:627,4400:628,4444:629,8092:630,6942:631,8267:632,2457:633,586:634,4893:635,4399:636,3411:637,7630:638,7018:639,2187:640,5993:641,7388:642,2504:643,7577:644,4227:645,6271:646,1397:647,4848:648,4621:649,1943:650,1645:651,7548:652,324:653,6948:654,5176:655,3079:656,2358:657,2402:658,3978:659,6623:660,3430:661,3162:662,1575:663,5288:664,1239:665,7543:666,1805:667,6804:668,1436:669,4481:670,2338:671,3034:672,786:673,5675:674,3914:675,5388:676,8280:677,6713:678,7807:679,5796:680,5282:681,8221:682,4752:683,4392:684,5785:685,5750:686,6720:687,4059:688,7447:689,6621:690,1591:691,3981:692,3758:693,1088:694,1955:695,6927:696,7424:697,3789:698,8339:699,5192:700,2779:701,6216:702,5836:703,3738:704,3832:705,2029:706,6250:707,4892:708,657:709,5530:710,7954:711,7341:712,2870:713,1897:714,2197:715,7821:716,4833:717,1207:718,6677:719,6035:720,5500:721,2942:722,7085:723,5729:724,1890:725,7844:726,8013:727,3668:728,2178:729,4822:730,3933:731,1520:732,7039:733,6882:734,7921:735,4964:736,2047:737,6437:738,6793:739,7660:740,4949:741,2701:742,3447:743,3395:744,600:745,4925:746,3147:747,4492:748,4865:749,5329:750,4871:751,4527:752,6130:753,2175:754,5955:755,2640:756,4472:757,841:758,4210:759,2070:760,7668:761,4688:762,6295:763,3165:764,3433:765,2934:766,1822:767,4224:768,4408:769,2023:770,1425:771,6136:772,4333:773,3292:774,7025:775,5026:776,1358:777,1201:778,305:779,5966:780,4823:781,5034:782,7816:783,1367:784,5323:785,8192:786,5494:787,4654:788,4642:789,4552:790,3459:791,4728:792,2784:793,5976:794,2752:795,4980:796,4214:797,1566:798,4359:799,3747:800,1097:801,5804:802,5194:803,6267:804,5830:805,4594:806,5248:807,7144:808,4579:809,5844:810,4582:811,3764:812,7951:813,6932:814,670:815,798:816,6641:817,5630:818,7434:819,4673:820,7272:821,4386:822,7174:823,5033:824,5035:825,1143:826,6058:827,2709:828,4436:829,5195:830,6112:831,2494:832,5921:833,3979:834,974:835,7406:836,1028:837,6115:838,4068:839,3954:840,1969:841,7235:842,6221:843,7706:844,7301:845,6643:846,2905:847,5437:848,2078:849,711:850,4827:851,8518:852,620:853,5617:854,8212:855,3821:856,1844:857,3436:858,901:859,6721:860,7398:861,6761:862,7392:863,4653:864,1842:865,1971:866,2162:867,5577:868,5918:869,4674:870,3846:871,7239:872,6207:873,6752:874,2396:875,1884:876,5643:877,2575:878,2126:879,8262:880,6583:881,6321:882,7923:883,3060:884,2781:885,5721:886,951:887,6587:888,6258:889,7770:890,8240:891,7034:892,2210:893,5716:894,5300:895,4506:896,1006:897,4526:898,7541:899,7558:900,2627:901,6645:902,1800:903,6777:904,6231:905,1242:906,8193:907,3756:908,2637:909,7022:910,5724:911,1557:912,8035:913,6427:914,2152:915,7119:916,3427:917,7946:918,8227:919,2286:920,5762:921,4326:922,8169:923,1854:924,1828:925,6291:926,5626:927,5520:928,3019:929,5771:930,3386:931,5387:932,1288:933,849:934,2222:935,980:936,890:937,4917:938,1644:939,7175:940,8460:941,5822:942,8135:943,2723:944,5668:945,676:946,6849:947,7580:948,4283:949,4101:950,1841:951,4575:952,7012:953,1187:954,6286:955,8295:956,690:957,3333:958,2593:959,2204:960,8176:961,7482:962,5177:963,983:964,1372:965,986:966,3712:967,800:968,5378:969,928:970,898:971,7294:972,1252:973,6019:974,2940:975,2134:976,640:977,4715:978,1064:979,4361:980,7555:981,2676:982,3616:983,6185:984,1168:985,2274:986,4668:987,4373:988,7756:989,1317:990,3054:991,8090:992,6773:993,4626:994,854:995,7989:996,6612:997,6963:998,4601:999,7941:1000,4768:1001,2447:1002,4862:1003,3957:1004,7342:1005,1325:1006,7672:1007,4216:1008,4851:1009,4845:1010,5734:1011,4788:1012,6771:1013,6974:1014,5914:1015,3744:1016,4474:1017,6742:1018,840:1019,6229:1020,922:1021,6604:1022,1354:1023,628:1024,5672:1025,4560:1026,6881:1027,7143:1028,2877:1029,4854:1030,2216:1031,5498:1032,5355:1033,677:1034,3864:1035,843:1036,2563:1037,2499:1038,6125:1039,2819:1040,6329:1041,6889:1042,6696:1043,5866:1044,2911:1045,5829:1046,5739:1047,5839:1048,4181:1049,5644:1050,4345:1051,6122:1052,5272:1053,8302:1054,3409:1055,2348:1056,4237:1057,5703:1058,1300:1059,5052:1060,3144:1061,6517:1062,5638:1063,4729:1064,3212:1065,1038:1066,1193:1067,4097:1068,1583:1069,5322:1070,7931:1071,7727:1072,7164:1073,4367:1074,7990:1075,4810:1076,2705:1077,8067:1078,4078:1079,5188:1080,4285:1081,2369:1082,1174:1083,3469:1084,2844:1085,8243:1086,7978:1087,4315:1088,5048:1089,751:1090,4391:1091,3845:1092,6501:1093,3633:1094,8203:1095,4882:1096,4730:1097,6794:1098,5313:1099,2310:1100,6555:1101,5510:1102,6579:1103,5025:1104,4015:1105,3811:1106,5561:1107,8134:1108,1486:1109,1857:1110,8216:1111,5216:1112,4820:1113,7451:1114,2042:1115,2147:1116,4876:1117,8022:1118,7886:1119,8088:1120,6416:1121,633:1122,7796:1123,2807:1124,1016:1125,5580:1126,2328:1127,2075:1128,1162:1129,6359:1130,4528:1131,6962:1132,6343:1133,6251:1134,6715:1135,2597:1136,1695:1137,1466:1138,3634:1139,6367:1140,8081:1141,6759:1142,6778:1143,3211:1144,7534:1145,6354:1146,5695:1147,5876:1148,4484:1149,2987:1150,824:1151,4950:1152,3733:1153,6598:1154,3118:1155,6421:1156,8478:1157,6589:1158,1592:1159,4921:1160,3370:1161,3607:1162,664:1163,4517:1164,1542:1165,2786:1166,7059:1167,5401:1168,5298:1169,2117:1170,3217:1171,8199:1172,5665:1173,7077:1174,6336:1175,4583:1176,2512:1177,2467:1178,6201:1179,5213:1180,1750:1181,7781:1182,5637:1183,698:1184,5961:1185,1217:1186,5377:1187,5578:1188,3198:1189,1975:1190,4382:1191,5311:1192,6780:1193,3055:1194,7162:1195,1573:1196,1316:1197,1020:1198,5330:1199,4468:1200,706:1201,8244:1202,7890:1203,6462:1204,5693:1205,8167:1206,7252:1207,4941:1208,4027:1209,8410:1210,8362:1211,1260:1212,3029:1213,655:1214,7471:1215,5009:1216,3246:1217,7264:1218,2678:1219,1298:1220,2052:1221,6561:1222,5008:1223,8492:1224,7355:1225,3741:1226,7245:1227,6503:1228,1755:1229,799:1230,7485:1231,7441:1232,4248:1233,6088:1234,6631:1235,7532:1236,6698:1237,4099:1238,2994:1239,1306:1240,7227:1241,5928:1242,2466:1243,7519:1244,4542:1245,8500:1246,5999:1247,6854:1248,1445:1249,1370:1250,4551:1251,1210:1252,909:1253,4647:1254,2927:1255,5598:1256,8128:1257,6784:1258,6751:1259,6424:1260,2408:1261,4230:1262,1910:1263,2064:1264,5556:1265,2782:1266,2009:1267,1376:1268,6907:1269,4580:1270,7472:1271,8470:1272,4185:1273,5910:1274,4306:1275,4969:1276,5933:1277,8400:1278,6767:1279,2422:1280,6176:1281,4776:1282,5676:1283,5715:1284,8211:1285,2217:1286,6036:1287,4130:1288,8463:1289,6299:1290,4609:1291,4519:1292,6548:1293,2767:1294,2397:1295,1756:1296,4009:1297,3768:1298,2560:1299,8197:1300,1270:1301,896:1302,6596:1303,7257:1304,8072:1305,8506:1306,4266:1307,2923:1308,1558:1309,5865:1310,7554:1311,680:1312,5412:1313,2417:1314,1140:1315,8419:1316,4622:1317,1146:1318,8351:1319,1456:1320,4821:1321,2017:1322,2761:1323,6210:1324,8271:1325,4940:1326,7737:1327,4430:1328,4687:1329,4651:1330,7461:1331,1635:1332,6590:1333,2076:1334,1400:1335,6312:1336,4649:1337,4196:1338,2114:1339,1570:1340,3010:1341,8305:1342,899:1343,7550:1344,4922:1345,8133:1346,6746:1347,3705:1348,7403:1349,7383:1350,8398:1351,7772:1352,39:1353,8465:1354,7504:1355,3092:1356,8391:1357,2444:1358,7994:1359,6113:1360,1135:1361,8220:1362,4232:1363,3111:1364,4166:1365,4514:1366,969:1367,2503:1368,2308:1369,2234:1370,4113:1371,2167:1372,7431:1373,2349:1374,1346:1375,2037:1376,7892:1377,5615:1378,2950:1379,2839:1380,7988:1381,5742:1382,2972:1383,7043:1384,656:1385,5776:1386,8041:1387,7499:1388,8406:1389,5346:1390,6516:1391,748:1392,1613:1393,6663:1394,6042:1395,7992:1396,5221:1397,5013:1398,8075:1399,6920:1400,7249:1401,5936:1402,5040:1403,4385:1404,8127:1405,5020:1406,6438:1407,6960:1408,894:1409,4451:1410,6445:1411,1014:1412,3837:1413,8233:1414,5178:1415,4169:1416,2893:1417,7843:1418,3780:1419,5849:1420,1944:1421,1560:1422,1002:1423,1864:1424,3032:1425,2236:1426,1313:1427,6673:1428,8443:1429,6599:1430,8501:1431,6799:1432,2137:1433,682:1434,5639:1435,4700:1436,4764:1437,3295:1438,7610:1439,6938:1440,1198:1441,2039:1442,887:1443,4856:1444,3038:1445,5749:1446,1967:1447,7271:1448,665:1449,5170:1450,4005:1451,8412:1452,6015:1453,5869:1454,6830:1455,4754:1456,7163:1457,1152:1458,1051:1459,6639:1460,5236:1461,6173:1462,7196:1463,6863:1464,5597:1465,3950:1466,3397:1467,3401:1468,3273:1469,5448:1470,3776:1471,6051:1472,5215:1473,5132:1474,1556:1475,8217:1476,7016:1477,6371:1478,5859:1479,7888:1480,8373:1481,6532:1482,6829:1483,5932:1484,6172:1485,8079:1486,2341:1487,4471:1488,3537:1489,2472:1490,1241:1491,3058:1492,3757:1493,3999:1494,6313:1495,4069:1496,7304:1497,8376:1498,5722:1499,2314:1500,4644:1501,8309:1502,4086:1503,1423:1504,5479:1505,1192:1506,7346:1507,5845:1508,7011:1509,4537:1510,1649:1511,4363:1512,740:1513,4864:1514,4693:1515,7068:1516,6781:1517,3611:1518,7201:1519,3070:1520,3661:1521,7681:1522,6943:1523,5649:1524,4886:1525,8214:1526,5808:1527,1776:1528,8489:1529,4904:1530,1183:1531,5015:1532,7401:1533,3359:1534,8249:1535,2753:1536,8125:1537,7773:1538,7067:1539,2041:1540,6571:1541,5197:1542,7522:1543,5413:1544,4858:1545,7731:1546,4635:1547,3152:1548,1419:1549,3107:1550,1937:1551,6585:1552,8363:1553,359:1554,8488:1555,1679:1556,3332:1557,2756:1558,7123:1559,4944:1560,4554:1561,4906:1562,2974:1563,7003:1564,4321:1565,6097:1566,1957:1567,3229:1568,1790:1569,1653:1570,6911:1571,4331:1572,958:1573,5873:1574,4896:1575,5486:1576,785:1577,713:1578,4930:1579,5708:1580,6936:1581,5432:1582,6985:1583,6123:1584,5185:1585,3865:1586,6857:1587,3869:1588,7801:1589,7129:1590,1408:1591,5841:1592,4364:1593,7279:1594,2524:1595,851:1596,2088:1597,2624:1598,8375:1599,4967:1600,3446:1601,1871:1602,2695:1603,4405:1604,4393:1605,1361:1606,1773:1607,5397:1608,4179:1609,8347:1610,1514:1611,1440:1612,5295:1613,2202:1614,924:1615,1453:1616,6259:1617,1968:1618,1418:1619,4184:1620,3992:1621,4731:1622,7928:1623,5249:1624,7885:1625,5863:1626,2376:1627,7546:1628,3364:1629,7122:1630,6198:1631,7674:1632,8011:1633,3003:1634,4001:1635,6813:1636,8317:1637,5783:1638,3146:1639,1437:1640,3638:1641,1676:1642,2919:1643,2102:1644,6026:1645,5781:1646,4257:1647,2890:1648,593:1649,5985:1650,4681:1651,4507:1652,7411:1653,4431:1654,2838:1655,4699:1656,869:1657,2815:1658,2218:1659,8102:1660,7344:1661,7573:1662,4032:1663,1577:1664,4765:1665,4115:1666,2673:1667,5460:1668,2715:1669,888:1670,956:1671,6443:1672,2745:1673,1171:1674,6526:1675,2909:1676,6903:1677,5700:1678,4045:1679,2917:1680,8005:1681,7381:1682,5582:1683,6788:1684,1170:1685,7578:1686,7037:1687,4607:1688,2104:1689,7387:1690,2405:1691,881:1692,8432:1693,6469:1694,4927:1695,1285:1696,8378:1697,6366:1698,8185:1699,7324:1700,7038:1701,6346:1702,5429:1703,4789:1704,4267:1705,4608:1706,7901:1707,1550:1708,8129:1709,8487:1710,3538:1711,1081:1712,7594:1713,7455:1714,6000:1715,2101:1716,7626:1717,2268:1718,8052:1719,7922:1720,7489:1721,4584:1722,2510:1723,4670:1724,1719:1725,5337:1726,1091:1727,4890:1728,5309:1729,2015:1730,6512:1731,2233:1732,2440:1733,7677:1734,4476:1735,1606:1736,8026:1737,3252:1738,7363:1739,5571:1740,4971:1741,4567:1742,4518:1743,4455:1744,1874:1745,7806:1746,6944:1747,6038:1748,2230:1749,4320:1750,4211:1751,3255:1752,2881:1753,2758:1754,2082:1755,1948:1756,1545:1757,7903:1758,2835:1759,4664:1760,4249:1761,5938:1762,5261:1763,4188:1764,878:1765,8025:1766,7622:1767,6111:1768,5483:1769,5765:1770,3765:1771,4569:1772,5487:1773,6736:1774,4376:1775,2875:1776,6811:1777,2975:1778,2062:1779,4910:1780,3477:1781,8324:1782,7015:1783,3072:1784,7950:1785,6978:1786,5899:1787,7182:1788,3402:1789,1307:1790,1196:1791,7985:1792,7628:1793,5956:1794,2221:1795,7322:1796,4171:1797,1905:1798,3450:1799,5465:1800,2003:1801,653:1802,7964:1803,6667:1804,5367:1805,5718:1806,2543:1807,7612:1808,6535:1809,2999:1810,6776:1811,4548:1812,2392:1813,1634:1814,7061:1815,5370:1816,6814:1817,2431:1818,5681:1819,5431:1820,5267:1821,1988:1822,7531:1823,4378:1824,3975:1825,1540:1826,2061:1827,4794:1828,6206:1829,4191:1830,3035:1831,1327:1832,4124:1833,5315:1834,1322:1835,3996:1836,3214:1837,6986:1838,6921:1839,1271:1840,6188:1841,5946:1842,5131:1843,1256:1844,7845:1845,7794:1846,4497:1847,1966:1848,6197:1849,5469:1850,4727:1851,7786:1852,6806:1853,2275:1854,1778:1855,2380:1856,4390:1857,8411:1858,967:1859,5790:1860,3931:1861,2018:1862,8439:1863,7734:1864,3866:1865,5778:1866,4119:1867,1546:1868,673:1869,6230:1870,6513:1871,2608:1872,8104:1873,4662:1874,5259:1875,3802:1876,4071:1877,3075:1878,1677:1879,8230:1880,2645:1881,7661:1882,914:1883,6085:1884,4741:1885,1387:1886,5705:1887,8206:1888,6745:1889,4012:1890,3151:1891,1762:1892,2639:1893,6226:1894,4446:1895,3170:1896,2251:1897,7179:1898,5909:1899,1349:1900,710:1901,7592:1902,2780:1903,4168:1904,2345:1905,7822:1906,6818:1907,2246:1908,7832:1909,7243:1910,5552:1911,4544:1912,8117:1913,8073:1914,2237:1915,6933:1916,5712:1917,3067:1918,1893:1919,8397:1920,4648:1921,2866:1922,7400:1923,6363:1924,5306:1925,2208:1926,2080:1927,5696:1928,2783:1929,1786:1930,2869:1931,2089:1932,1620:1933,5225:1934,4631:1935,4377:1936,2635:1937,4972:1938,2287:1939,7638:1940,2482:1941,2414:1942,8028:1943,6539:1944,8258:1945,6879:1946,5768:1947,1686:1948,5555:1949,5003:1950,8100:1951,2129:1952,6468:1953,3546:1954,2448:1955,6193:1956,2343:1957,857:1958,8407:1959,7973:1960,3262:1961,3095:1962,2433:1963,1774:1964,6056:1965,2546:1966,7105:1967,6288:1968,5642:1969,5361:1970,2836:1971,1063:1972,7659:1973,1267:1974,4779:1975,8045:1976,2712:1977,7834:1978,5308:1979,3606:1980,4458:1981,2928:1982,5671:1983,4677:1984,2598:1985,6121:1986,2106:1987,4802:1988,4388:1989,4978:1990,1727:1991,2049:1992,7647:1993,4640:1994,2992:1995,1460:1996,2671:1997,1412:1998,1291:1999,7492:2000,4836:2001,3959:2002,1264:2003,1449:2004,7184:2005,3398:2006,1366:2007,7329:2008,4381:2009,2747:2010,6651:2011,1568:2012,8259:2013,4756:2014,4512:2015,7581:2016,6821:2017,7145:2018,7976:2019,4327:2020,3535:2021,5602:2022,3453:2023,1726:2024,8368:2025,6840:2026,784:2027,6220:2028,599:2029,905:2030,8429:2031,8179:2032,4295:2033,3796:2034,2053:2035,7583:2036,5001:2037,309:2038,1055:2039,6205:2040,2724:2041,681:2042,2766:2043,782:2044,1896:2045,7851:2046,4106:2047,2371:2048,2136:2049,1209:2050,7740:2051,7021:2052,4547:2053,6325:2054,5560:2055,1963:2056,4231:2057,6420:2058,3967:2059,3670:2060,2812:2061,2289:2062,4748:2063,1523:2064,7597:2065,2790:2066,7100:2067,4487:2068,3683:2069,3365:2070,3806:2071,7632:2072,5872:2073,2813:2074,8459:2075,6902:2076,4706:2077,7203:2078,5362:2079,3673:2080,7713:2081,3049:2082,2406:2083,5051:2084,2282:2085,8095:2086,6182:2087,5920:2088,4450:2089,1915:2090,6542:2091,3936:2092,2416:2093,6762:2094,6061:2095,4561:2096,7327:2097,1363:2098,7425:2099,5691:2100,2186:2101,7487:2102,6635:2103,5581:2104,7357:2105,5595:2106,3422:2107,991:2108,7604:2109,1293:2110,4485:2111,4457:2112,8048:2113,7165:2114,7019:2115,6322:2116,1869:2117,2952:2118,2943:2119,7617:2120,4240:2121,4449:2122,3610:2123,3876:2124,1962:2125,8490:2126,5415:2127,7378:2128,6060:2129,5692:2130,2628:2131,7446:2132,3233:2133,7635:2134,7063:2135,1181:2136,651:2137,7611:2138,6697:2139,6314:2140,4052:2141,8247:2142,1144:2143,7445:2144,6186:2145,2288:2146,1797:2147,4349:2148,2179:2149,8089:2150,5312:2151,4060:2152,3237:2153,2858:2154,1305:2155,8202:2156,1767:2157,8051:2158,2443:2159,3743:2160,2763:2161,1166:2162,6928:2163,4628:2164,4177:2165,930:2166,4332:2167,4380:2168,8328:2169,4801:2170,4503:2171,5590:2172,3263:2173,825:2174,8044:2175,7148:2176,5439:2177,4878:2178,5376:2179,1599:2180,868:2181,4453:2182,1544:2183,7232:2184,8409:2185,7700:2186,2171:2187,6934:2188,5433:2189,6949:2190,1098:2191,8336:2192,1642:2193,6181:2194,4261:2195,2795:2196,2384:2197,7362:2198,4170:2199,3375:2200,2238:2201,7565:2202,1093:2203,8162:2204,5738:2205,3110:2206,4777:2207,2100:2208,8449:2209,6874:2210,6630:2211,5725:2212,2670:2213,5422:2214,5244:2215,4816:2216,5641:2217,5596:2218,3336:2219,7829:2220,6451:2221,1082:2222,7241:2223,6352:2224,7716:2225,5473:2226,6753:2227,2250:2228,5050:2229,3810:2230,3116:2231,2032:2232,1485:2233,7827:2234,2113:2235,3385:2236,2323:2237,6109:2238,3221:2239,1422:2240,4540:2241,6007:2242,4831:2243,6315:2244,2988:2245,334:2246,8387:2247,7517:2248,6617:2249,3652:2250,3078:2251,2609:2252,8315:2253,1616:2254,7017:2255,6700:2256,1934:2257,6459:2258,5912:2259,6628:2260,3968:2261,4024:2262,1687:2263,6099:2264,4595:2265,4524:2266,3374:2267,7975:2268,3036:2269,2681:2270,7662:2271,7233:2272,6057:2273,4460:2274,6233:2275,1279:2276,5554:2277,6330:2278,4079:2279,2112:2280,7720:2281,4905:2282,3740:2283,6279:2284,4111:2285,1834:2286,6174:2287,4641:2288,6034:2289,2108:2290,7284:2291,4313:2292,1680:2293,1134:2294,1058:2295,4975:2296,4456:2297,5373:2298,842:2299,8481:2300,5553:2301,4692:2302,2244:2303,1697:2304,6001:2305,3104:2306,1737:2307,7283:2308,3068:2309,1032:2310,7663:2311,3665:2312,7811:2313,4592:2314,2553:2315,2284:2316,290:2317,8078:2318,957:2319,960:2320,6100:2321,1925:2322,7561:2323,7030:2324,4319:2325,2583:2326,972:2327,5471:2328,1657:2329,1247:2330,4934:2331,3209:2332,1234:2333,7176:2334,6458:2335,5434:2336,1389:2337,6968:2338,5395:2339,3870:2340,1853:2341,7739:2342,4915:2343,4581:2344,4462:2345,6887:2346,5049:2347,4292:2348,3840:2349,1760:2350,7767:2351,8472:2352,3253:2353,2019:2354,1554:2355,8508:2356,4742:2357,3222:2358,2799:2359,4961:2360,3192:2361,1394:2362,6328:2363,4063:2364,3620:2365,7797:2366,4691:2367,6543:2368,4840:2369,3974:2370,2936:2371,2961:2372,2363:2373,1213:2374,4611:2375,3218:2376,1167:2377,877:2378,3801:2379,8131:2380,2544:2381,7312:2382,1722:2383,4859:2384,4100:2385,3797:2386,2714:2387,4199:2388,5014:2389,7310:2390,5793:2391,7938:2392,3076:2393,6010:2394,5163:2395,7521:2396,2581:2397,1685:2398,7212:2399,4763:2400,2193:2401,5493:2402,3751:2403,3236:2404,5848:2405,2528:2406,6023:2407,4513:2408,7837:2409,7462:2410,704:2411,8308:2412,6845:2413,6766:2414,4942:2415,6326:2416,5736:2417,8071:2418,6600:2419,8349:2420,3173:2421,7942:2422,4352:2423,705:2424,7366:2425,6362:2426,4194:2427,2720:2428,1301:2429,2099:2430,1529:2431,1018:2432,3965:2433,4565:2434,2118:2435,1235:2436,6823:2437,2613:2438,1661:2439,1596:2440,6684:2441,3244:2442,4110:2443,1717:2444,597:2445,6533:2446,5567:2447,7721:2448,7605:2449,6285:2450,2689:2451,2573:2452,7833:2453,6440:2454,4733:2455,2514:2456,1923:2457,1200:2458,6309:2459,5622:2460,2851:2461,1633:2462,6988:2463,5663:2464,4690:2465,3043:2466,2925:2467,2398:2468,2110:2469,1600:2470,1595:2471,5759:2472,2245:2473,8024:2474,7480:2475,5565:2476,2722:2477,6292:2478,2163:2479,7131:2480,2020:2481,5449:2482,4636:2483,8263:2484,4965:2485,7846:2486,4213:2487,1650:2488,4403:2489,4098:2490,6695:2491,5853:2492,3269:2493,3027:2494,8049:2495,6003:2496,5855:2497,5690:2498,8454:2499,7830:2500,7071:2501,6276:2502,4055:2503,5451:2504,1761:2505,1724:2506,1789:2507,2339:2508,1587:2509,7466:2510,5828:2511,2885:2512,3729:2513,6725:2514,5193:2515,4948:2516,4665:2517,2802:2518,2313:2519,1837:2520,1734:2521,3684:2522,3565:2523,2632:2524,1939:2525,3135:2526,2427:2527,1286:2528,4260:2529,8222:2530,4067:2531,3719:2532,7515:2533,7218:2534,612:2535,6537:2536,2391:2537,1594:2538,5769:2539,8361:2540,3677:2541,1482:2542,1227:2543,615:2544,7180:2545,5331:2546,1758:2547,6904:2548,8483:2549,7435:2550,2335:2551,3077:2552,8344:2553,8343:2554,8023:2555,5816:2556,3928:2557,3858:2558,6246:2559,5285:2560,5232:2561,8476:2562,3809:2563,3259:2564,1070:2565,3940:2566,3134:2567,6848:2568,5165:2569,659:2570,8038:2571,6660:2572,5385:2573,4751:2574,4452:2575,6566:2576,5948:2577,1383:2578,4242:2579,2027:2580,8218:2581,7478:2582,5421:2583,4389:2584,4193:2585,1335:2586,7824:2587,3680:2588,1548:2589,1911:2590,7213:2591,3275:2592,5679:2593,1057:2594,8456:2595,8068:2596,1212:2597,6514:2598,6118:2599,4775:2600,8042:2601,7585:2602,3841:2603,1571:2604,993:2605,772:2606,6769:2607,6255:2608,4204:2609,2077:2610,8293:2611,5541:2612,4282:2613,4241:2614,1698:2615,1593:2616,8471:2617,5636:2618,6317:2619,4924:2620,7147:2621,4366:2622,7251:2623,5797:2624,4757:2625,5036:2626,3406:2627,1374:2628,709:2629,6225:2630,4529:2631,3942:2632,2083:2633,5430:2634,7599:2635,6556:2636,2616:2637,572:2638,7609:2639,5411:2640,6991:2641,4419:2642,2926:2643,2198:2644,1202:2645,7220:2646,2856:2647,2201:2648,1513:2649,1369:2650,6739:2651,5452:2652,3149:2653,2207:2654,1344:2655,1500:2656,915:2657,7723:2658,3794:2659,8187:2660,1336:2661,2226:2662,7306:2663,4203:2664,3082:2665,2986:2666,6559:2667,4916:2668,7538:2669,6211:2670,5455:2671,5919:2672,2607:2673,1324:2674,795:2675,8137:2676,1732:2677,6620:2678,6344:2679,4459:2680,2726:2681,1660:2682,4689:2683,3859:2684,6972:2685,5031:2686,4918:2687,3340:2688,7828:2689,4233:2690,2333:2691,8138:2692,7305:2693,7183:2694,4982:2695,3120:2696,2296:2697,1567:2698,6569:2699,5688:2700,2662:2701,8207:2702,7265:2703,3731:2704,2668:2705,2883:2706,7962:2707,4301:2708,7849:2709,1435:2710,643:2711,8181:2712,3948:2713,2674:2714,1112:2715,3653:2716,2862:2717,1878:2718,789:2719,4832:2720,3817:2721,3514:2722,2439:2723,3612:2724,7643:2725,6435:2726,4946:2727,3963:2728,3004:2729,8228:2730,8033:2731,7710:2732,7193:2733,8274:2734,7158:2735,5840:2736,2577:2737,1004:2738,6339:2739,7896:2740,7303:2741,6364:2742,4109:2743,2346:2744,2024:2745,7330:2746,6878:2747,4737:2748,2551:2749,1488:2750,7439:2751,6347:2752,5237:2753,2316:2754,5600:2755,1835:2756,1579:2757,921:2758,7060:2759,6592:2760,5456:2761,5336:2762,1386:2763,7984:2764,7817:2765,4279:2766,1509:2767,903:2768,8276:2769,4928:2770,3358:2771,1941:2772,3807:2773,6002:2774,1087:2775,4842:2776,4362:2777,2889:2778,4760:2779,6689:2780,7906:2781,929:2782,4797:2783,1141:2784,4195:2785,3812:2786,2646:2787,2304:2788,5390:2789,3862:2790,1825:2791,7491:2792,6747:2793,6047:2794,3046:2795,6280:2796,3982:2797,1840:2798,4568:2799,8467:2800,7512:2801,5461:2802,3838:2803,3679:2804,3419:2805,2552:2806,2474:2807,7645:2808,5974:2809,7655:2810,7248:2811,5310:2812,2025:2813,1659:2814,7331:2815,5496:2816,7507:2817,6316:2818,6069:2819,5462:2820,3874:2821,2473:2822,1839:2823,7689:2824,6924:2825,6867:2826,3085:2827,2151:2828,6557:2829,1716:2830,6183:2831,5184:2832,7708:2833,7262:2834,7255:2835,2906:2836,2519:2837,8519:2838,1879:2839,7214:2840,4353:2841,8341:2842,2626:2843,7516:2844,3878:2845,777:2846,6011:2847,5814:2848,6627:2849,5833:2850,3861:2851,3760:2852,2180:2853,7198:2854,2692:2855,2063:2856,1690:2857,8054:2858,7673:2859,3863:2860,8007:2861,6828:2862,6656:2863,6102:2864,1617:2865,8037:2866,6203:2867,5499:2868,1549:2869,584:2870,4749:2871,6669:2872,6423:2873,5196:2874,3613:2875,1748:2876,7682:2877,6955:2878,3168:2879,7957:2880,3860:2881,7246:2882,2959:2883,2824:2884,2686:2885,8466:2886,8039:2887,7765:2888,7642:2889,6918:2890,4475:2891,649:2892,8148:2893,7574:2894,1526:2895,3984:2896,6020:2897,4573:2898,1508:2899,580:2900,8246:2901,3545:2902,2948:2903,7774:2904,6324:2905,5566:2906,5332:2907,2511:2908,1728:2909,1438:2910,4082:2911,8069:2912,5867:2913,2865:2914,1872:2915,6945:2916,6839:2917,1527:2918,1111:2919,3698:2920,6607:2921,4427:2922,4160:2923,3132:2924,1664:2925,6520:2926,5335:2927,6615:2928,4881:2929,4447:2930,3697:2931,2665:2932,6138:2933,1946:2934,7450:2935,1409:2936,1274:2937,6880:2938,5480:2939,3960:2940,2610:2941,4947:2942,3130:2943,2021:2944,3604:2945,8085:2946,8064:2947,5470:2948,1949:2949,3143:2950,2506:2951,1360:2952,7339:2953,7787:2954,7237:2955,7042:2956,4153:2957,1926:2958,1160:2959,2559:2960,1927:2961,5838:2962,3943:2963,2957:2964,2820:2965,5320:2966,8043:2967,8421:2968,6724:2969,6331:2970,2322:2971,7935:2972,4990:2973,2618:2974,1912:2975,7234:2976,6530:2977,2621:2978,6184:2979,3615:2980,2840:2981,6925:2982,5794:2983,1718:2984,1158:2985,7120:2986,3695:2987,2764:2988,3682:2989,1362:2990,1749:2991,4955:2992,2477:2993,3650:2994,3583:2995,2956:2996,3250:2997,2955:2998,2732:2999,988:3000,8053:3001,4080:3002,1662:3003,3172:3004,2634:3005,344:3006,2716:3007,7728:3008,6970:3009,5719:3010,6916:3011,2383:3012,2161:3013,1049:3014,8436:3015,7080:3016,5570:3017,4016:3018,2823:3019,1735:3020,1092:3021,2740:3022,1581:3023,1380:3024,4817:3025,2785:3026,7791:3027,3270:3028,6200:3029,4300:3030,4182:3031,3808:3032,1589:3033,6134:3034,4107:3035,3044:3036,2389:3037,6247:3038,1614:3039,1433:3040,7274:3041,5467:3042,2741:3043,3700:3044,5482:3045,5454:3046,3013:3047,6091:3048,4495:3049,2685:3050,708:3051,7818:3052,5706:3053,5047:3054,4702:3055,4716:3056,6693:3057,6426:3058,3699:3059,3600:3060,2661:3061,7296:3062,1683:3063,5697:3064,4963:3065,1615:3066,764:3067,7514:3068,7066:3069,5903:3070,2939:3071,7902:3072,6609:3073,3160:3074,859:3075,5930:3076,3681:3077,2830:3078,4505:3079,4154:3080,8065:3081,4091:3082,4880:3083,1832:3084,8495:3085,5653:3086,3235:3087,5039:3088,1373:3089,4589:3090,2299:3091,3114:3092,2717:3093,1730:3094,4454:3095,2622:3096,1658:3097,7202:3098,7081:3099,955:3100,1656:3101,794:3102,5726:3103,2340:3104,8086:3105,7722:3106,6436:3107,5711:3108,5450:3109,4541:3110,3649:3111,2667:3112,2606:3113,2441:3114,1847:3115,1746:3116,7575:3117,5420:3118,2770:3119,1909:3120,1478:3121,3231:3122,3090:3123,2868:3124,8425:3125,2490:3126,953:3127,7939:3128,6716:3129,3636:3130,3417:3131,8059:3132,6836:3133,5559:3134,4988:3135,3614:3136,2629:3137,2330:3138,6006:3139,1908:3140,1647:3141,1036:3142,787:3143,6846:3144,3617:3145,332:3146,8047:3147,1371:3148,7407:3149,6319:3150,4051:3151,3678:3152,3093:3153,7963:3154,6682:3155,5851:3156,3175:3157,2500:3158,5394:3159,3045:3160,6365:3161,2153:3162,876:3163,8143:3164,5714:3165,3635:3166,1484:3167,4571:3168,3403:3169,2641:3170,6045:3171,3826:3172,683:3173,6997:3174,4633:3175,5846:3176,5228:3177,1986:3178,734:3179,7072:3180,3618:3181,2687:3182,1536:3183,6431:3184,5898:3185,3456:3186,6212:3187,5229:3188,7335:3189,8070:3190,7225:3191,3658:3192,2769:3193,4669:3194,7995:3195,5843:3196,4778:3197,4365:3198,1005:3199,925:3200,8074:3201,6357:3202,8401:3203,4516:3204,1875:3205,2947:3206,2900:3207,2125:3208,1441:3209,5770:3210,4425:3211,911:3212,766:3213,7598:3214,1933:3215,1580:3216,7437:3217,4256:3218,1851:3219,6434:3220,3205:3221,3017:3222,2762:3223,2754:3224,1655:3225,3087:3226,7125:3227,2620:3228,1738:3229,892:3230,875:3231,6922:3232,5466:3233,2536:3234,8453:3235,8123:3236,6586:3237,2475:3238,6337:3239,5481:3240,4158:3241,2476:3242,809:3243,1880:3244,1262:3245,4734:3246,1563:3247,4805:3248,3123:3249,1873:3250,8032:3251,4429:3252,1700:3253,2810:3254,7242:3255,642:3256,3727:3257,8350:3258,7477:3259,5926:3260,5497:3261,7033:3262,6236:3263,5662:3264,3240:3265,3129:3266,1638:3267,5916:3268,7850:3269,6208:3270,6016:3271,5350:3272,4870:3273,3438:3274,7803:3275,7572:3276,6335:3277,4819:3278,3536:3279,2916:3280,2691:3281,6552:3282,5874:3283,4739:3284,3443:3285,3251:3286,1810:3287,7449:3288,6239:3289,1652:3290,6505:3291,5743:3292,5477:3293,3713:3294,1866:3295,8464:3296,8437:3297,6775:3298,3702:3299,3696:3300,4834:3301,2654:3302,1723:3303,5881:3304,3112:3305,1601:3306,8326:3307,8299:3308,1331:3309,6050:3310,6947:3311,6199:3312,1021:3313,7699:3314,4322:3315,2908:3316,2526:3317,966:3318,5436:3319,3439:3320,8124:3321,7780:3322,2235:3323,2120:3324,6774:3325,6672:3326,5485:3327,1585:3328,7808:3329,6290:3330,6005:3331,6261:3332,3785:3333,3040:3334,2038:3335,7676:3336,5472:3337,5230:3338,3827:3339,1552:3340,4735:3341,3071:3342,1684:3343,6562:3344,4861:3345,4407:3346,3800:3347,8097:3348,6888:3349,6456:3350,2677:3351,1586:3352,1359:3353,3020:3354,2623:3355,1759:3356,5864:3357,5661:3358,4995:3359,2700:3360,7614:3361,7247:3362,3037:3363,2826:3364,1764:3365,1578:3366,2696:3367,3662:3368,2602:3369,1543:3370,3412:3371,2487:3372,675:3373,2372:3374,1924:3375,1588:3376,1309:3377,8008:3378,5523:3379,5453:3380,3728:3381,1637:3382,8062:3383,1096:3384,4736:3385,4064:3386,2739:3387,7160:3388,6801:3389,3189:3390,2619:3391,2502:3392,6298:3393,3122:3394,1669:3395,7669:3396,6763:3397,2941:3398,1960:3399,1176:3400,5475:3401,3836:3402,1502:3403,340:3404,5409:3405,3879:3406,3089:3407,2471:3408,8189:3409,8027:3410,4671:3411,3065:3412,1802:3413,7273:3414,4933:3415,1553:3416,7671:3417,4825:3418,4178:3419,3014:3420,3234:3421,2853:3422,1612:3423,7118:3424,5850:3425,2729:3426,1940:3427,7838:3428,6796:3429,3204:3430,2719:3431,1752:3432,2707:3433,1605:3434,3074:3435,2630:3436,1564:3437,1303:3438,1072:3439,6956:3440,1428:3441,7199:3442,2907:3443,3124:3444,2699:3445,1714:3446,6139:3447,5404:3448,5375:3449,1894:3450,7207:3451,3435:3452,3266:3453,2945:3454,2093:3455,4994:3456,3000:3457,1109:3458,7112:3459,1110:3460,4187:3461,1654:3462,1528:3463,1074:3464,7768:3465,7607:3466,4286:3467,3805:3468,2329:3469,5333:3470,3814:3471,2899:3472,2381:3473,1223:3474,788:3475,4913:3476,7291:3477,6563:3478,6432:3479,6008:3480,4603:3481,1565:3482,316:3483,7124:3484,5857:3485,3912:3486,3605:3487,8286:3488,8372:3489,7755:3490,7188:3491,3672:3492,1916:3493,1751:3494,7991:3495,4445:3496,4287:3497,779:3498,4493:3499,4013:3500,3429:3501,1754:3502,8057:3503,7775:3504,7560:3505,6896:3506,3203:3507,1729:3508,742:3509,5334:3510,3589:3511,4371:3512,3701:3513,7498:3514,7167:3515,1643:3516,8056:3517,4081:3518,1559:3519,6856:3520,3428:3521,3088:3522,6834:3523,3441:3524,3437:3525,4461:3526,910:3527,2529:3528,1136:3529,5474:3530,4132:3531,2684:3532,2014:3533,1740:3534,3125:3535,2264:3536,1678:3537,6901:3538,3952:3539,2680:3540,8141:3541,1763:3542,6105:3543,3609:3544,2139:3545,1392:3546,8080:3547,3663:3548,7309:3549,330:3550,7900:3551,8200:3552,1688:3553,1702:3554,4888:3555,8414:3556,7530:3557,1043:3558,7070:3559,1069:3560,630:3561,6982:3562,4093:3563,3533:3564,1114:3565,6249:3566,6022:3567,5723:3568,4987:3569,6979:3570,2332:3571,5683:3572,4062:3573,2558:3574,8126:3575,3851:3576,2679:3577,2604:3578,7069:3579,6941:3580,5484:3581,5038:3582,4875:3583,1356:3584,6256:3585,3449:3586,1887:3587,6508:3588,6041:3589,5410:3590,3883:3591,679:3592,2315:3593,5527:3594,8171:3595,7965:3596,4061:3597,7000:3598,1663:3599,1491:3600,7394:3601,5558:3602,3353:3603,8310:3604,8058:3605,3779:3606,3721:3607,1332:3608,846:3609,696:3610,694:3611,647:3612,8002:3613,7484:3614,6658:3615,5686:3616,5647:3617,3654:3618,2964:3619,1765:3620,661:3621,7958:3622,7649:3623,7490:3624,7380:3625,6444:3626,5270:3627,4343:3628,4219:3629,2127:3630,1870:3631,7618:3632,7110:3633,4796:3634,4676:3635,3730:3636,2142:3637,2086:3638,1190:3639,1184:3640,632:3641,6666:3642,6119:3643,5657:3644,5634:3645,5257:3646,3371:3647,2938:3648,2690:3649,1947:3650,7730:3651,7287:3652,6779:3653,5835:3654,5772:3655,5763:3656,5495:3657,5304:3658,3777:3659,2166:3660,1919:3661,1155:3662,1046:3663,7685:3664,7535:3665,7224:3666,6959:3667,3962:3668,2605:3669,1931:3670,1920:3671,885:3672,7253:3673,7074:3674,7073:3675,6650:3676,6616:3677,4680:3678,2004:3679,1547:3680,1504:3681,590:3682,7670:3683,7288:3684,6790:3685,6646:3686,6601:3687,6082:3688,5970:3689,5347:3690,5324:3691,5252:3692,4190:3693,4074:3694,4036:3695,3926:3696,3823:3697,2702:3698,2561:3699,1747:3700,780:3701,8386:3702,8101:3703,7453:3704,7088:3705,6360:3706,6272:3707,6262:3708,3745:3709,2991:3710,2935:3711,2822:3712,2209:3713,1597:3714,7993:3715,7960:3716,7757:3717,7603:3718,7552:3719,7460:3720,6946:3721,6782:3722,6744:3723,6649:3724,6422:3725,6283:3726,6132:3727,5255:3728,5011:3729,4900:3730,4898:3731,4787:3732,4536:3733,4424:3734,4387:3735,2827:3736,2452:3737,2421:3738,2319:3739,2170:3740,2138:3741,1699:3742,1694:3743,1692:3744,1691:3745,1607:3746,1604:3747,1603:3748,1507:3749,1506:3750,7616:3751,7300:3752,7280:3753,7230:3754,6876:3755,6634:3756,6547:3757,6439:3758,6141:3759,6084:3760,5958:3761,5862:3762,5438:3763,5342:3764,5302:3765,5041:3766,4992:3767,4011:3768,3788:3769,3774:3770,3769:3771,3421:3772,3360:3773,2894:3774,2800:3775,2710:3776,2028:3777,1807:3778,1743:3779,1501:3780,1404:3781,1304:3782,8477:3783,8461:3784,8442:3785,8388:3786,8278:3787,8239:3788,8226:3789,8142:3790,8118:3791,8000:3792,7970:3793,7800:3794,7651:3795,7633:3796,7619:3797,7595:3798,7544:3799,7536:3800,7467:3801,7333:3802,7295:3803,7258:3804,7250:3805,7102:3806,7079:3807,6951:3808,6905:3809,6809:3810,6711:3811,6681:3812,6606:3813,6603:3814,6417:3815,6361:3816,6353:3817,6282:3818,6281:3819,6217:3820,6191:3821,6094:3822,6013:3823,5995:3824,5973:3825,5954:3826,5934:3827,5694:3828,5269:3829,5187:3830,4959:3831,4866:3832,4824:3833,4772:3834,4661:3835,4616:3836,4574:3837,4508:3838,4499:3839,4498:3840,4480:3841,4417:3842,4394:3843,4374:3844,4192:3845,4127:3846,3993:3847,3822:3848,3748:3849,3711:3850,3158:3851,3100:3852,2663:3853,2501:3854,2484:3855,2459:3856,2429:3857,2331:3858,2249:3859,2123:3860,2087:3861,1994:3862,1985:3863,1935:3864,1928:3865,1913:3866,1799:3867,1788:3868,1779:3869,1696:3870,1689:3871,1608:3872,1602:3873,1569:3874,1538:3875,1505:3876,1197:3877,1194:3878,1169:3879,579:3880,8452:3881,8396:3882,8360:3883,8359:3884,8334:3885,8322:3886,8270:3887,8219:3888,8204:3889,8198:3890,8145:3891,7805:3892,7751:3893,7103:3894,5986:3895,4885:3896,4479:3897,4162:3898,2846:3899,2809:3900,2734:3901,2733:3902,2564:3903,2483:3904,2395:3905,2326:3906,2196:3907,2195:3908,2192:3909,1991:3910,1974:3911,1862:3912,1827:3913,1826:3914,1794:3915,1793:3916,1781:3917,1711:3918,1710:3919,1639:3920,1629:3921,1628:3922,1541:3923,1519:3924,1499:3925,1497:3926,1496:3927,1490:3928,1448:3929,1442:3930,1417:3931,1416:3932,1391:3933,1334:3934,1261:3935,1129:3936,1013:3937,1012:3938,1011:3939,1010:3940,1009:3941,933:3942,728:3943,8496:3944,8357:3945,8356:3946,8355:3947,8354:3948,8353:3949,8352:3950,8194:3951,8144:3952,7820:3953,7646:3954,7624:3955,7500:3956,7206:3957,6967:3958,6803:3959,6626:3960,6536:3961,6080:3962,5296:3963,4957:3964,4937:3965,4884:3966,4869:3967,4795:3968,4338:3969,3784:3970,3710:3971,3347:3972,3121:3973,2871:3974,2833:3975,2735:3976,2633:3977,2582:3978,2578:3979,2470:3980,2418:3981,2279:3982,2224:3983,2194:3984,1990:3985,1787:3986,1777:3987,1742:3988,1551:3989,1333:3990,1259:3991,1254:3992,1175:3993,1154:3994,1027:3995,1019:3996,1008:3997,801:3998,7456:3999,4914:4000,2742:4001,2580:4002,1439:4003}
        # self.vb_range = [1270,1800,17600,20000,34000,34600,50000,51999,66999,67999,83999,84999,99999,100999,115999,117999,132999,133999,148999,149999,163999,182999,197999,199999,214999,215999,230999,231999,247999,248999,263999,264999,279999,280999,296999,297999,312999,313999,328999,330999,345999,346999,361999,362999,378999,379999,394999,395999,410999,412999,427999,428999,443999,444999,460999,461999,476999,477999,492999,493999,509999,510999,525999,526999,541999,543999,558999,559999,574999,575999,591999,592999,607999,608999,623999,624999,640999,641999,656999,657999,673999,674999,689999,690999]

        # self.dict_wiki = {}
        # self.doc_ids = {}
        # self.body_gap = {}

    def vb_encode(self, number):
        bytes = []

        while True:
            bytes.insert(0, number % 128)
            if number < 128:
                break
            number /= 128
        bytes[-1] += 128

        vbp = pack('%dB' % len(bytes), *bytes)
        if not bool(re.search('\n', vbp)):
            return vbp
        else:
            return str(number)

    def wikiClean(self, prop):
        def isEnglish(s):
            try:
                s.encode(encoding='utf-8').decode('ascii')
            except UnicodeDecodeError:
                return False
            else:
                return True

        prop_list = re.split(WIKI_DELIMITERS, prop)
        nsw_prop_list = filter(lambda x: len(x) > 2, prop_list) # remove empty list
        filter_prop_list = filter(lambda x: isEnglish(x), nsw_prop_list)

        lower_prop_list = map(lambda x:x.lower(), filter_prop_list) # case fold
        lower_prop_list = filter(lambda x: x not in self.stop_words, lower_prop_list) # remove stop words
        return lower_prop_list

    def parseWikiDump(self, onlyfiles):

        def parse(file_json):
            with open(DUMP_PATH+file_json) as data_file:
                data = json.load(data_file)

            for doc in data["wikidump"]:
                title = doc["title"]
                text = doc["text"]

                if not text:
                    continue

                doc_id = int(doc["id"])

                word_list = self.wikiClean(text)

                doc_ID[doc_id] = len(word_list)
                doc_titles[doc_id] = title

        doc_ID = {}
        doc_titles = {}

        map(lambda x: parse(x), onlyfiles)

        return (doc_ID, doc_titles)

def threads(name, files, i, j, total_indexes):

    start_time = time.time()

    generate_inidx = InvertedIndex()
    (doc_ID, doc_titles) = generate_inidx.parseWikiDump(files)

    return (name, time.time() - start_time, i , j, doc_ID, doc_titles)

if __name__ == '__main__':

    onlydir = [d for d in listdir(DUMP_PATH) if os.path.isdir(join(DUMP_PATH, d))]
    onlydir.sort()

    onlyfiles = [d+"/"+f for d in onlydir for f in listdir(DUMP_PATH + d) if isfile(join(DUMP_PATH + d, f))]
    onlyfiles.sort()
    files_len = len(onlyfiles)

    final_doc_ID = {}
    final_doc_titles = {}

    # Start pool
    pool = multiprocessing.Pool(multiprocessing.cpu_count())

    # Build task list
    tasks = []
    sections = SECTIONS
    total_indexes = int(math.ceil(float(files_len) / float(sections)))

    for i in xrange(0, files_len, sections):
        end = i + sections
        if i + sections > files_len:
            end = files_len
        tasks.append( ( str(i / sections), onlyfiles[i:end], onlyfiles[i], onlyfiles[end-1], str(total_indexes), ) )
    
    # Run tasks
    results = [pool.apply_async( threads, t ) for t in tasks]

    # Process results
    for result in results:
        (name, thread_time, i, j, doc_ID, doc_titles) = result.get()
        final_doc_ID.update(doc_ID)
        final_doc_titles.update(doc_titles)
        print("Thread t-%s completed, took %d seconds for files from %s to %s" % (name, thread_time, i, j) )

    pool.close()
    pool.join()

    with open('doc_ID_128.json', 'w') as fp:
    	json.dump(final_doc_ID, fp)

    with open('doc_titles_128.json', 'w') as fp:
    	json.dump(final_doc_titles, fp)
